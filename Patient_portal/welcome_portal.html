<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TrueEval Patient Portal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0; padding: 0; min-height: 100vh;
            background: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            color: #222;
        }
        .container { max-width: 1100px; margin: 40px auto; padding: 20px; }
        .header { background: rgba(255,255,255,0.95); padding: 22px; border-radius: 14px; backdrop-filter: blur(6px); box-shadow: 0 8px 24px rgba(0,0,0,0.12); }
        .header h1 { margin: 0 0 6px 0; font-size: 2rem; font-weight: 700; color: #333; }
        .dashboard { display: grid; grid-template-columns: 320px 1fr; gap: 24px; margin-top: 18px; }
        .sidebar { background: #fff; border-radius: 12px; padding: 18px; }
        .main-content { background: #fff; border-radius: 12px; padding: 18px; }
        .patient-info h2 { margin-top: 0; font-size: 1.1rem; }
        .info-item { display:flex; justify-content:space-between; padding:6px 0; border-bottom:1px dashed #eee; }
        .action-button { display:inline-block; background:#667eea; color:white; border:none; padding:10px 14px; border-radius:8px; cursor:pointer; font-weight:600; }
        .action-button.secondary{ background:#f1f3f5; color:#333; border:1px solid #e6e9ef; }
        .action-button.warning{ background:#ffc107; color:#222; }
        .status-card{ padding:12px; border-radius:10px; margin-bottom:12px; }
        .progress-bar{ background:#f1f3f5; border-radius:8px; height:10px; overflow:hidden; }
        .progress-fill{ height:100%; background:linear-gradient(90deg,#667eea,#764ba2); width:0%; transition:width .6s ease; }
        .hidden{ display:none; }
        .fade-in{ animation: fadeIn .45s ease both; }
        @keyframes fadeIn{ from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:none} }
        .intake-form .form-group{ margin-bottom:12px; }
        .intake-form input, .intake-form textarea, .intake-form select{ width:100%; padding:10px; border:1px solid #e9ecef; border-radius:8px; }
        canvas.signature-pad{ width:100%; height:140px; background:white; border:1px solid #e9ecef; border-radius:8px; }
        @media (max-width:820px){ .dashboard{ grid-template-columns:1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-heart-pulse"></i> TrueEval Patient Portal</h1>
            <p style="margin:6px 0 0 0;color:#666;">Secure telehealth intake and consultation platform</p>
        </div>

        <div class="dashboard">
            <aside class="sidebar">
                <div class="patient-info">
                    <h2><i class="fas fa-user-circle"></i> Patient Information</h2>
                    <div class="info-item"><span class="info-label">Name:</span><strong id="patient-name">John Doe</strong></div>
                    <div class="info-item"><span class="info-label">Email:</span><span id="patient-email">john.doe@example.com</span></div>
                    <div class="info-item"><span class="info-label">DOB:</span><span id="patient-dob">01/15/1985</span></div>
                    <div style="margin-top:12px">
                        <button class="action-button" onclick="startNewIntake()"><i class="fas fa-plus"></i> Start New Consultation</button>
                    </div>
                    <div style="margin-top:12px">
                        <button class="action-button secondary" onclick="viewHistory()"><i class="fas fa-history"></i> View History</button>
                    </div>
                </div>
            </aside>

            <main class="main-content">
                <div class="status-card" id="status-card">
                    <div style="display:flex;justify-content:space-between;align-items:center">
                        <div>
                            <div id="status-title"><strong>Ready to Start Your Consultation</strong></div>
                            <div id="status-description" style="color:#666; font-size:0.95rem; margin-top:6px;">Complete your secure intake form to connect with a provider.</div>
                        </div>
                        <div style="width:240px">
                            <div class="progress-bar"><div id="progress-fill" class="progress-fill"></div></div>
                            <div id="progress-text" style="text-align:right;font-size:0.85rem;color:#666;margin-top:6px;">0% Complete</div>
                        </div>
                    </div>
                </div>

                <div id="content-area">
                    <section id="welcome-screen" class="fade-in">
                        <div class="alert" style="background:#e9f5ff;padding:12px;border-radius:8px;border:1px solid #d7eefc;color:#045;">
                            <strong>Welcome to TrueEval!</strong> Your secure telehealth platform for convenient, professional healthcare consultations.
                        </div>
                        <h3 style="margin-top:16px"><i class="fas fa-stethoscope"></i> How It Works</h3>
                        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin-top:12px">
                            <div style="background:#fbfdff;padding:10px;border-radius:8px;border:1px solid #f0f4ff;text-align:center">Complete Intake</div>
                            <div style="background:#fbfdff;padding:10px;border-radius:8px;border:1px solid #f0f4ff;text-align:center">Provider Review</div>
                            <div style="background:#fbfdff;padding:10px;border-radius:8px;border:1px solid #f0f4ff;text-align:center">Care Plan Delivered</div>
                        </div>
                    </section>

                    <section id="intake-form-screen" class="hidden">
                        <form id="intake-form" class="intake-form" onsubmit="handleSubmit(event)">
                            <div class="form-section" id="section-personal">
                                <h4>Personal Information</h4>
                                <div class="form-group"><label>First Name *</label><input id="firstName" required></div>
                                <div class="form-group"><label>Last Name *</label><input id="lastName" required></div>
                                <div class="form-group"><label>Date of Birth *</label><input id="dateOfBirth" type="date" required></div>
                            </div>

                            <div class="form-section hidden" id="section-medical">
                                <h4>Medical History</h4>
                                <div class="form-group"><label>Known Allergies</label><textarea id="allergies"></textarea></div>
                            </div>

                            <div class="form-section hidden" id="section-symptoms">
                                <h4>Current Symptoms</h4>
                                <div class="form-group"><label>Main Concern *</label><textarea id="chiefComplaint" required></textarea></div>
                                <div class="form-group"><label>Pain Level</label><input id="painScale" type="range" min="0" max="10" value="0" oninput="updatePainValue(this.value)"><div style="text-align:right;font-size:0.9rem;color:#666" id="painValue">0</div></div>
                            </div>

                            <div class="form-section hidden" id="section-documents">
                                <h4>Upload Documents</h4>
                                <div class="document-upload" onclick="document.getElementById('fileInput').click()" style="padding:12px;border:1px dashed #e2e8f0;border-radius:8px;text-align:center">Click to upload</div>
                                <input id="fileInput" type="file" multiple style="display:none" onchange="handleFileUpload(event)">
                                <div id="uploadedFiles" style="margin-top:8px"></div>
                            </div>

                            <div class="form-section hidden" id="section-consent">
                                <h4>Consent</h4>
                                <div style="margin-bottom:8px"><label><input id="hipaaConsent" type="checkbox"> I accept HIPAA terms</label></div>
                                <div><label><input id="treatmentConsent" type="checkbox"> I consent to treatment</label></div>
                                <div style="margin-top:12px"><label>Signature</label><canvas id="signaturePad" class="signature-pad"></canvas><div style="margin-top:8px"><button type="button" class="btn-clear" onclick="clearSignature()">Clear</button></div></div>
                            </div>

                            <div style="display:flex;justify-content:space-between;margin-top:14px">
                                <div><button type="button" id="prevButton" class="action-button secondary" onclick="previousSection()">Previous</button></div>
                                <div style="display:flex;gap:8px"><button type="button" id="nextButton" class="action-button" onclick="nextSection()">Next</button><button type="submit" id="submitButton" class="action-button hidden">Submit</button></div>
                            </div>
                        </form>
                    </section>

                    <section id="completion-screen" class="hidden">
                        <div class="alert" style="background:#e9f7ee;border:1px solid #d4efd9;padding:12px;border-radius:8px;color:#155724"><strong>Intake Completed Successfully!</strong></div>
                    </section>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Basic multi-section form logic (cleaned)
        let currentSection = 0;
        const formSections = ['personal','medical','symptoms','documents','consent'];

        document.addEventListener('DOMContentLoaded', ()=>{
            updateNavigation(); updateProgress(); initializeSignaturePad();
        });

        function startNewIntake(){
            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('intake-form-screen').classList.remove('hidden');
            currentSection = 0; showSection(currentSection); updateStatus('In Progress','',0);
        }
        function showSection(i){
            formSections.forEach((s,idx)=>{
                const el=document.getElementById('section-'+s);
                if(!el) return;
                if(idx===i){ el.classList.remove('hidden'); el.classList.add('fade-in'); }
                else { el.classList.add('hidden'); el.classList.remove('fade-in'); }
            });
            updateNavigation();
        }
        function nextSection(){ if(!validateCurrentSection()) return; if(currentSection < formSections.length-1){ currentSection++; showSection(currentSection); updateProgress(); } }
        function previousSection(){ if(currentSection>0){ currentSection--; showSection(currentSection); updateProgress(); } }
        function updateNavigation(){ const prev=document.getElementById('prevButton'), next=document.getElementById('nextButton'), submit=document.getElementById('submitButton'); if(prev) prev.style.display = currentSection===0?'none':'inline-block'; if(submit && next){ if(currentSection===formSections.length-1){ next.classList.add('hidden'); submit.classList.remove('hidden'); } else { next.classList.remove('hidden'); submit.classList.add('hidden'); } } }
        function validateCurrentSection(){ const sec=document.getElementById('section-'+formSections[currentSection]); if(!sec) return true; const required=sec.querySelectorAll('[required]'); for(let f of required){ if(!f.value || !f.value.trim()){ alert('Please fill required fields'); f.focus(); return false; } } if(formSections[currentSection]==='consent'){ const h=document.getElementById('hipaaConsent'), t=document.getElementById('treatmentConsent'); if(!h.checked || !t.checked){ alert('Please accept consents'); return false; } } return true; }
        function updateProgress(){ const pct = Math.round(((currentSection+1)/formSections.length)*100); const fill=document.getElementById('progress-fill'); const txt=document.getElementById('progress-text'); if(fill) fill.style.width = pct + '%'; if(txt) txt.textContent = pct + '% Complete'; }
        function updateStatus(title,desc,percent){ const t=document.getElementById('status-title'), d=document.getElementById('status-description'); if(t) t.textContent = title; if(d) d.textContent = desc || d.textContent; if(percent!==undefined){ const fill=document.getElementById('progress-fill'); if(fill) fill.style.width = percent + '%'; } }
        function viewHistory(){ alert('View history (demo)'); }
        function downloadRecords(){ alert('Download records (demo)'); }
        function contactSupport(){ alert('Contact support (demo)'); }
        function resetDashboard(){ location.reload(); }
        function updatePainValue(v){ const el=document.getElementById('painValue'); if(el) el.textContent = v; }
        function handleFileUpload(e){ const out=document.getElementById('uploadedFiles'); out.innerHTML = ''; for(let f of e.target.files){ const d=document.createElement('div'); d.textContent = f.name; out.appendChild(d); } }
        function handleSubmit(e){ e.preventDefault(); document.getElementById('intake-form-screen').classList.add('hidden'); document.getElementById('completion-screen').classList.remove('hidden'); updateStatus('Completed','Your intake has been submitted.',100); }

        // Simple signature pad stub (not production)
        let signaturePad; function initializeSignaturePad(){ const c=document.getElementById('signaturePad'); if(!c) return; const ctx=c.getContext('2d'); ctx.fillStyle='white'; ctx.fillRect(0,0,c.width,c.height); let drawing=false; c.addEventListener('pointerdown',()=>drawing=true); c.addEventListener('pointerup',()=>drawing=false); c.addEventListener('pointermove',(ev)=>{ if(!drawing) return; const r=c.getBoundingClientRect(); const x=ev.clientX-r.left, y=ev.clientY-r.top; ctx.fillStyle='#000'; ctx.beginPath(); ctx.arc(x,y,2,0,Math.PI*2); ctx.fill(); }); }
        function clearSignature(){ const c=document.getElementById('signaturePad'); if(!c) return; const ctx=c.getContext('2d'); ctx.clearRect(0,0,c.width,c.height); ctx.fillStyle='white'; ctx.fillRect(0,0,c.width,c.height); }
    </script>

    <script src="portal.js"></script>
</body>
</html>
